<h1>統計情報</h1>

<h2>残高</h2>
<div class="">
  ¥<%= @total.to_s(:delimited) %>
</div>

<h2>アカウント残高</h2>

<div class="col-5 ml-3">
  <table class="table" id="table_accounts">
    <thead>
      <tr>
        <th>アカウント</th>
        <th>金額</th>
        <th></th>
      </tr>
    </thead>

    <% @accounts.each do |account| %>

    <tbody>
      <tr>
        <td><%= account.name %></td>
        <td>¥<%= account.value.to_s(:delimited) %></td>
        <td><%= link_to "削除", user_account_path(params[:user_id], account.id), method: :DELETE, data: {confirm: "削除してよろしいですか？", "turbolinks" => false} %></td>
      </tr>
    </tbody>

    <% end %>

  </table>
</div>



<ul class="nav-list">
  <li class="nav-list-item">
    <%= link_to "新規振替", new_user_account_exchange_path(params[:user_id]), data: {"turbolinks" => false} %>
  </li>
  <li class="nav-list-item">
    <%= link_to "アカウント新規作成", new_user_account_path(params[:user_id]), data: {"turbolinks" => false} %>
  </li>
  <li class="nav-list-item">
    <%= link_to "振替履歴", user_account_exchanges_path(params[:user_id]), data: {"turbolinks" => false} %>
  </li>
</ul>

<h2>月ごとの収支</h2>

<% if @events!=[] %>

<div class="col-5 ml-3">
  <table class="table" id="pm">
    <thead>
      <tr>
        <th>年</th>
        <th class="border-right">月</th>
        <th>収入</th>
        <th class="border-right">支出</th>
        <th>収支</th>
      </tr>
    </thead>

    <% a=0 %>
    <% @month_pm_paginate.each do |month_pm_genre| %>

    <tbody>
      <tr>
        <% if a != month_pm_genre[:year] %>
        <td><%= month_pm_genre[:year] %>年</td>
        <% else %>
        <td></td>
        <% end %>

        <td class="border-right"><%= month_pm_genre[:month] %>月</td>
        <td>¥<%= month_pm_genre[:in].to_s(:delimited) %></td>
        <td class="border-right">¥-<%= month_pm_genre[:out].to_s(:delimited) %></td>
        <td>¥<%= month_pm_genre[:pm].to_s(:delimited) %></td>
      </tr>
    </tbody>

    <% a=month_pm_genre[:year] %>
    <% end %>
    <%= will_paginate @month_pm_paginate, :param_name => 'month', class: "center" %>

  </table>
</div>

<div class="col-5 ml-3">
  <table class="table" id="pm">
    <thead>
      <tr>
        <th>年</th>
        <th class="border-right">月</th>

        <% @genres_array_e.each do |genre| %>
        <% if genre==@genres_array_e.last %>
        <th class="border-right">
          <%= genre %>
        </th>
        <% else %>
        <th>
          <%= genre %>
        </th>
        <% end %>
        <% end %>

        <% @genres_array_i.each do |genre| %>
        <th>
          <%= genre %>
        </th>
        <% end %>

      </tr>
    </thead>

    <% a=0 %>
    <% @month_pm_paginate.each do |month_pm_genre| %>

    <tbody>
      <tr>
        <% if a != month_pm_genre[:year] %>
        <td><%= month_pm_genre[:year] %>年</td>
        <% else %>
        <td></td>
        <% end %>

        <td class="border-right"><%= month_pm_genre[:month] %>月</td>

        <% @genres_array_e.each do |genre| %>
        <% if genre==@genres_array_e.last %>
        <td class="border-right">¥<%= month_pm_genre[genre].to_s(:delimited) %></td>
        <% else %>
        <td>¥<%= month_pm_genre[genre].to_s(:delimited) %></td>
        <% end %>
        <% end %>

        <% @genres_array_i.each do |genre| %>
        <td>¥<%= month_pm_genre[genre].to_s(:delimited) %></td>
        <% end %>
      </tr>
    </tbody>

    <% a=month_pm_genre[:year] %>
    <% end %>
    <%= will_paginate @month_pm_paginate, :param_name => 'month', class: "center" %>

  </table>
</div>

<% else %>

<p>まだイベントがありません</p>
<% end %>

<h2>年ごとの収支</h2>
<% if @events!=[] %>

<div class="col-5 ml-3">
  <table class="table" id="pm">
    <thead>
      <tr>
        <th class="border-right">年</th>
        <th>収入</th>
        <th class="border-right">支出</th>
        <th>収支</th>
      </tr>
    </thead>

    <% @year_pm_paginate.each do |year_pm_genre| %>
    <tbody>
      <tr>
        <td class="border-right"><%= year_pm_genre[:year] %>年</td>
        <td>¥<%= year_pm_genre[:in].to_s(:delimited) %></td>
        <td class="border-right">¥-<%= year_pm_genre[:out].to_s(:delimited) %></td>
        <td>¥<%= year_pm_genre[:pm].to_s(:delimited) %></td>
      </tr>
    </tbody>

    <% end %>
    <%= will_paginate @year_pm_paginate, :param_name => 'year', class: "center" %>

  </table>
</div>

<div class="col-5 ml-3">
  <table class="table" id="pm">
    <thead>
      <tr>
        <th class="border-right">年</th>

        <% @genres_array_e.each do |genre| %>
        <% if genre==@genres_array_e.last %>
        <th class="border-right">
          <%= genre %>
        </th>
        <% else %>
        <th>
          <%= genre %>
        </th>
        <% end %>
        <% end %>

        <% @genres_array_i.each do |genre| %>
        <th>
          <%= genre %>
        </th>
        <% end %>

      </tr>
    </thead>

    <% @year_pm_paginate.each do |year_pm_genre| %>
    <tbody>
      <tr>
        <td class="border-right"><%= year_pm_genre[:year] %>年</td>

        <% @genres_array_e.each do |genre| %>
        <% if genre==@genres_array_e.last %>
        <td class="border-right">¥<%= year_pm_genre[genre].to_s(:delimited) %></td>
        <% else %>
        <td>¥<%= year_pm_genre[genre].to_s(:delimited) %></td>
        <% end %>
        <% end %>

        <% @genres_array_i.each do |genre| %>
        <td>¥<%= year_pm_genre[genre].to_s(:delimited) %></td>
        <% end %>
      </tr>
    </tbody>

    <% end %>
    <%= will_paginate @year_pm_paginate, :param_name => 'year', class: "center" %>

  </table>
</div>

<% else %>

<p>まだイベントがありません</p>

<% end %>
